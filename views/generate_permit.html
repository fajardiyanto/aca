{{ define "content" }}
<style>
  table,
  th,
  td {
    border: 1px solid black;
  }

  table,
  td {
    text-align: center;
    font-weight: 600;
  }
</style>

<div>
  <div class="container" id="page-permit">
    <div class="row">
      <div class="col-lg-6 col-sm-12 mb-4">
        <div class="d-flex align-items-center justify-content-center">
          <div class="box">
            <div class="group">
              <div class="overlap-group">
                <div class="overlap">
                  <div class="rectangle"></div>
                  <div class="div"></div>
                  <div class="text-wrapper d-flex align-items-center justify-content-center">
                    <p id="name-permit" class="text-uppercase"></p>
                  </div>
                  <div class="data-user">
                    <div>
                      Reg :
                      <p class="reg" id="reg-permit"></p>
                    </div>
                    <div>
                      NIK :
                      <p class="nik" id="nik-permit"></p>
                    </div>
                    <div>
                      Perusahaan :
                      <p id="company-permit" class="company text-uppercase"></p>
                    </div>
                    <div>
                      Departemen :
                      <p id="departement-permit" class="departement text-uppercase"></p>
                    </div>
                    <div>
                      Jabatan :
                      <p id="position-permit" class="position"></p>
                    </div>
                  </div>
                  <div class="text-wrapper-2 d-flex">
                    Valid :
                    <p id="valid-permit" class="ml-1"></p>
                  </div>
                  <div class="rectangle-2" id="violationL1"></div>
                  <div class="rectangle-3" id="violationL2"></div>
                  <div class="rectangle-4" id="violationL3"></div>
                  <div class="text-wrapper-3">L1</div>
                  <div class="text-wrapper-4">L3</div>
                  <div class="text-wrapper-5">L2</div>
                </div>
                <div class="overlap-2">
                  <div class="overlap-3">
                    <div class="rectangle-5"></div>
                    <div class="rectangle-6"></div>
                    <div class="text-wrapper-6">MINE PERMIT</div>
                    <div id="type_permit" class="text-wrapper-7 text-uppercase"></div>
                  </div>
                  <img class="image" src="/assets/images/alamkaryalogo.png" />
                  <div class="text-wrapper-8">PT.ALAM KARYA GEMILANG</div>
                </div>
                <img id="img-profile" class="img" />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-6 col-sm-12 mb-4">
        <div class="d-flex align-items-center justify-content-center">
          <div class="box-side">
            <div class="group-side">
              <div class="overlap-group-side">
                <div class="overlap-side">
                  <div class="rectangle-100"></div>
                  <div class="background-side"></div>
                  <p class="text-head-name">
                    Marradian Dwi Pujana<br />Kepala Teknik Tambang
                  </p>
                  <div class="text-wrapper" id="valid_backside">Valid : 13-03-2024</div>
                  <div class="rectangle-20" id="violation_L1"></div>
                  <div class="rectangle-30" id="violation_L2"></div>
                  <div class="rectangle-40" id="violation_L3"></div>
                  <div class="text-wrapper-20">L1</div>
                  <div class="text-wrapper-30">L3</div>
                  <div class="text-wrapper-40">L2</div>
                  <div class="rectangle-50 d-flex align-items-center justify-content-center">
                    <img src="/assets/images/pak_puja.png" class="ttd" alt="" />
                  </div>
                </div>
                <div class="text-wrapper-50">PERHATIAN</div>
                <p>
                <ol type="1">
                  <li>ID Card ini berfungsi sebagai tanda pengenal di lingkungan kerja PT. Alam Karya Gemilang.</li>
                  <li>Wajib menggunakan ID Card di lingkungan kerja PT. Alam Karya Gemilang </li>
                  <li>Tidak dibenarkan memakai ID Card orang lain</li>
                  <li>Kehilangan ID Card dikenakan biaya penggantian sebesar Rp. 100.00,-</li>
                  <li>Bagi yang menemukan ID Card ini mohon agar dapat dikembalikan ke:</li>
                </ol>
                </p>
                <div class="text-wrapper-60">PT. Alam Karya Gemilang</div>
                <p class="head-office">
                  <span class="head-office-span">Head Office:<br /></span>
                  <span class="text-wrapper-70">Jl. MT. Haryono Perumahan Bukit Mediterania <br />Perkantoran No.
                    23-26<br />Air Putih Samarinda-Kalimantan Timur</span>
                </p>
                <p class="site-office">
                  <span class="office-span">Site Office:<br /></span>
                  <span class="text-wrapper-70">Jalan Poros Muara Badak<br />Desa Tanjung Limau<br />Kec. Muara
                    Badak</span>
                </p>
                <div class="image-side">
                  <img class="alamkaryalogo" src="https://alamkaryagemilang.com/alamkaryalogo.png" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex align-items-center justify-content-center">
    <a class="btn btn-danger text-white delete-btn" type="button" onclick="printPage()">Download Permit</a>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
  integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  $(document).ready(function () {
    var id = new URLSearchParams(window.location.search).get("id");

    $.ajax({
      url: "/detail/permit?id=" + id,
      method: "get",
      success: function (data) {
        const dataPermit = data.permit;
        if (dataPermit.type !== "karyawan") {
          var myTextElement = document.getElementById("type_permit");
          myTextElement.style.fontSize = "17px";
        }

        switch (dataPermit.violation) {
          case "L1":
          case "L2":
          case "L3":
            setBackgroundColorById('violation_' + dataPermit.violation, '#ffe500');
            setBackgroundColorById('violation' + dataPermit.violation, '#ffe500');
            break;
        }

        document.getElementById("name-permit").innerHTML = dataPermit.name;
        document.getElementById("nik-permit").innerHTML = dataPermit.nik;
        document.getElementById("reg-permit").innerHTML = dataPermit.region;
        document.getElementById("company-permit").innerHTML = dataPermit.company;
        document.getElementById("departement-permit").innerHTML =
          dataPermit.departement;
        document.getElementById("position-permit").innerHTML = dataPermit.position;
        document.getElementById("img-profile").src = "/" + dataPermit.image;
        document.getElementById("valid-permit").innerHTML = dataPermit.valid;
        document.getElementById("valid_backside").innerHTML = `Valid : ${dataPermit.valid}`;
        document.getElementById("type_permit").innerHTML = dataPermit.type;
      },
    });
  });

  function setBackgroundColorById(elementId, color) {
    var myDiv = document.getElementById(elementId);
    if (myDiv) {
      myDiv.style.backgroundColor = color;
    }
  }

  function printPage() {
    var page = document.getElementById("page-permit");
    var topMargin = 20;
    var opt = {
      margin: topMargin,
      filename: 'myfile.pdf',
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
    };

    html2pdf(page);
  }
</script>
{{ end }}