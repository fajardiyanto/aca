{{ define "content" }}
<style>
  table,
  th,
  td {
    border: 1px solid black;
  }
  table,
  td {
    text-align: center;
    font-weight: 600;
  }
</style>
<div class="container">
  <div class="row">
    <div class="col-lg-4 col-sm-12 mb-8">
      <div
        id="page-permit"
        class="d-flex align-items-center justify-content-center"
      >
        <div class="box">
          <div class="group">
            <div class="overlap-group">
              <div class="overlap">
                <div class="rectangle"></div>
                <div class="div"></div>
                <div
                  class="text-wrapper d-flex align-items-center justify-content-center"
                >
                  <p id="name-permit" class="text-uppercase"></p>
                </div>
                <div class="data-user">
                  <div>
                    Reg :
                    <p class="reg" id="reg-permit"></p>
                  </div>
                  <div>
                    NIK :
                    <p class="nik" id="nik-permit"></p>
                  </div>
                  <div>
                    Perusahaan :
                    <p id="company-permit" class="company text-uppercase"></p>
                  </div>
                  <div>
                    Departemen :
                    <p
                      id="departement-permit"
                      class="departement text-uppercase"
                    ></p>
                  </div>
                  <div>
                    Jabatan :
                    <p id="position-permit" class="position"></p>
                  </div>
                </div>
                <div class="text-wrapper-2 d-flex">
                  Valid :
                  <p id="valid-permit" class="ml-1"></p>
                </div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="rectangle-4"></div>
                <div class="text-wrapper-3" id="violationL1">L1</div>
                <div class="text-wrapper-4" id="violationL3">L3</div>
                <div class="text-wrapper-5" id="violationL2">L2</div>
              </div>
              <div class="overlap-2">
                <div class="overlap-3">
                  <div class="rectangle-5"></div>
                  <div class="rectangle-6"></div>
                  <div class="text-wrapper-6">MINE PERMIT</div>
                  <div id="type_permit" class="text-wrapper-7 text-uppercase"></div>
                </div>
                <img
                  class="image"
                  src="https://alamkaryagemilang.com/alamkaryalogo.png"
                />
                <div class="text-wrapper-8">PT.ALAM KARYA GEMILANG</div>
              </div>
              <img id="img-profile" class="img" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-4 col-sm-12">
      <div id="page-permit" class="d-flex align-items-center justify-content-center">
        <div class="box-side">
          <div class="group-side">
            <div class="overlap-group-side">
              <div class="overlap-side">
                <div class="rectangle-100"></div>
                <div class="background-side"></div>
                <p class="text-head-name">
                  Marradian Dwi Pujana<br />Kepala Teknik Tambang
                </p>
                <div class="text-wrapper" id="valid_backside">Valid : 13-03-2024</div>
                <div class="rectangle-20"></div>
                <div class="rectangle-30"></div>
                <div class="rectangle-40"></div>
                <div class="text-wrapper-20" id="violation_L1">L1</div>
                <div class="text-wrapper-30" id="violation_L3">L3</div>
                <div class="text-wrapper-40" id="violation_L2">L2</div>
                <div class="rectangle-50 d-flex align-items-center justify-content-center">
                  <img
                    src="/assets/images/pak_puja.png"
                    class="ttd"
                    alt=""
                  />
                </div>
              </div>
              <div class="text-wrapper-50">PERHATIAN</div>
              <p>
                  <ol type="1">
                      <li>ID Card ini berfungsi sebagai tanda pengenal di lingkungan kerja PT. Alam Karya Gemilang.</li>
                      <li>Wajib menggunakan ID Card di lingkungan kerja PT. Alam Karya Gemilang </li>
                      <li>Tidak dibenarkan memakai ID Card orang lain</li>
                      <li>Kehilangan ID Card dikenakan biaya penggantian sebesar Rp. 100.00,-</li>
                      <li>Bagi yang menemukan ID Card ini mohon agar dapat dikembalikan ke:</li>
                  </ol>
              </p>
              <div class="text-wrapper-60">PT. Alam Karya Gemilang</div>
              <p class="head-office">
                <span class="head-office-span">Head Office:<br /></span>
                <span class="text-wrapper-70"
                  >Jl. MT. Haryono Perumahan Bukit Mediterania <br />Perkantoran No.
                  23-26<br />Air Putih Samarinda-Kalimantan Timur</span
                >
              </p>
              <p class="site-office">
                <span class="office-span">Site Office:<br /></span>
                <span class="text-wrapper-70"
                  >Jalan Poros Muara Badak<br />Desa Tanjung Limau<br />Kec. Muara
                  Badak</span
                >
              </p>
              <div class="image-side">
                <img
                  class="alamkaryalogo"
                  src="https://alamkaryagemilang.com/alamkaryalogo.png"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-4 col-sm-12" id="simper-card">
      <div class="d-flex align-items-center justify-content-center">
        <div class="box-simper">
          <div class="group-simper">
            <div class="overlap-simper">
              <div class="rectangle-simper"></div>
              <div class="div-simper"></div>
              <div class="rectangle-simper-2"></div>
              <div class="rectangle-simper-3"></div>
              <div class="text-wrapper-simper" id="violation_simper_L3">L3</div>
              <div class="text-wrapper-simper-2" id="violation_simper_L1">L1</div>
              <div class="text-wrapper-simper-3" id="violation_simper_L2">L2</div>
              <div class="rectangle-simper-4 d-flex align-items-center justify-content-center">
                <img
                  src="/assets/images/pak_puja.png"
                  class="ttd"
                  alt=""
                />
              </div>
              <p class="head-of-eng-simper">
                Marradian Dwi Pujana<br />Kepala Teknik Tambang
              </p>
              <div class="rectangle-simper-5"></div>
              <div class="rectangle-simper-6"></div>
              <div class="overlap-group-wrapper-simper">
                <div class="overlap-group-simper" id="type_simpol_A">
                  <p class="text-wrapper-simper-5">A</p>
                </div>
              </div>
              <div class="overlap-wrapper-simper">
                <div class="div-wrapper-simper" id="type_simpol_BII">
                  <p class="text-wrapper-simper-6">BII</p>
                </div>
              </div>
              <div class="group-simper-2">
                <div class="div-wrapper-simper" id="type_simpol_BI">
                  <p class="text-wrapper-simper-7">BI</p>
                </div>
              </div>
              <div class="text-wrapper-simper-8">JENIS SIMPOL</div>
              <div class="text-wrapper-simper-9">SIMPER</div>
              <div class="rectangle-simper-7"></div>
              <div class="group-simper-3">
                <div class="overlap-group-simper" id="type_simper_P">
                  <p class="text-wrapper-simper-5">P</p>
                </div>
              </div>
              <div class="group-simper-4">
                <div class="div-wrapper-simper" id="type_simper_R">
                  <p class="text-wrapper-simper-5">R</p>
                </div>
              </div>
              <div class="group-simper-5">
                <div class="div-wrapper-simper" id="type_simper_Q">
                  <p class="text-wrapper-simper-5">Q</p>
                </div>
              </div>
              <div class="text-wrapper-simper-10">JENIS SIMPER</div>
              <div class="group-simper-6">
                <div class="overlap-group-simper" id="gol_darah_A">
                  <p class="text-wrapper-simper-5">A</p>
                </div>
              </div>
              <div class="group-simper-7">
                <div class="div-wrapper-simper" id="gol_darah_AB">
                  <p class="text-wrapper-simper-11">AB</p>
                </div>
              </div>
              <div class="group-simper-8">
                <div class="div-wrapper-simper" id="gol_darah_O">
                  <p class="text-wrapper-simper-5">O</p>
                </div>
              </div>
              <div class="group-simper-9">
                <div class="div-wrapper-simper" id="gol_darah_B">
                  <p class="text-wrapper-simper-5">B</p>
                </div>
              </div>
              <div class="text-wrapper-simper-12">GOL DARAH</div>
              <div class="text-wrapper-simper-13">No SIMPOL</div>
              <div class="text-wrapper-simper-14">Masa Berlaku</div>
              <div class="text-wrapper-simper-15">Masa SIMPER</div>
              <div class="text-wrapper-simper-16" id="no_simpol">: 941019310641</div>
              <div class="text-wrapper-simper-17" id="valid_permit">: 12-10-2023</div>
              <div class="text-wrapper-simper-18" id="valid_simper">: 12-10-2023</div>
              <div class="text-wrapper-simper-19">JENIS PERALATAN</div>
              <div class="group-simper-10">
                <table class="col-12 center-table" id="vehicle-list">
                  
                </table>
              </div>
      
              <p class="kehilangan-SIMPER">
                Kehilangan SIMPER &amp; PERMIT dikenakan denda<br />Rp. 100.000,-<br />SIMPER
                wajib dibawa pada saat<br />mengoperasikan unit atau kendaraan
              </p>
              <div class="text-wrapper-simper-28">Pelanggaran</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"
></script>
<script>
  function setBackgroundColorById(elementId, color) {
    var myDiv = document.getElementById(elementId);
    if (myDiv) {
      myDiv.style.backgroundColor = color;
    }
  }

  $(document).ready(function () {
    var id = new URLSearchParams(window.location.search).get("id");

    $.ajax({
      url: "/detail/permit?id=" + id,
      method: "get",
      success: function (data) {
        const dataPermit = data.permit;
        const dataSimper = data.simper;
        if (dataPermit.type !== "karyawan") {
          var myTextElement = document.getElementById("type_permit");
          myTextElement.style.fontSize = "17px";
        }

        switch (dataPermit.violation) {
            case "L1":
            case "L2":
            case "L3":
              setBackgroundColorById('violation_simper_' + dataPermit.violation, '#ffe500');
              setBackgroundColorById('violation_' + dataPermit.violation, '#ffe500');
              setBackgroundColorById('violation' + dataPermit.violation, '#ffe500');
              break;
        }

        if (dataPermit.is_simper) {
          switch (dataSimper.simper_type) {
            case "P":
            case "Q":
            case "R":
              setBackgroundColorById('type_simper_' + dataSimper.simper_type, '#ffe500');
              break;
          }

          switch (dataSimper.simpol) {
            case "A":
            case "BI":
            case "BII":
              setBackgroundColorById('type_simpol_' + dataSimper.simpol, '#ffe500');
              break;
          }

          switch (dataSimper.blood_type) {
            case "A":
            case "B":
            case "O":
            case "AB":
              setBackgroundColorById('gol_darah_' + dataSimper.blood_type, '#ffe500');
              break;
          }

          
          let htmlTable = '';
          for (let i = 0; i < 5; i++) {
            const row = dataSimper.vehicle[i] || {}; // Use an empty object if the item is undefined
            const typeVehicle = (row.type_vehicle || '').toUpperCase();

            htmlTable += `
              <tr>
                <td>${i + 1}</td>
                <td style="background-color: ${typeVehicle === 'F' ? '#ffe500' : 'inherit'};">F</td>
                <td style="background-color: ${typeVehicle === 'P' ? '#ffe500' : 'inherit'};">P</td>
                <td style="background-color: ${typeVehicle === 'T' ? '#ffe500' : 'inherit'};">T</td>
                <td>${row.name_vehicle || ''}</td>
              </tr>
            `;
          }
          $("#vehicle-list").html(htmlTable);

          document.getElementById("valid_simper").innerHTML = `: ${dataSimper.simper_valid}`;
          document.getElementById("no_simpol").innerHTML = `: ${dataSimper.no_simpol}`;
        } else {
          const elementSimper = document.getElementById("simper-card");
          elementSimper.classList.add("d-none");
        }

        document.getElementById("name-permit").innerHTML = dataPermit.name;
        document.getElementById("nik-permit").innerHTML = dataPermit.nik;
        document.getElementById("reg-permit").innerHTML = dataPermit.region;
        document.getElementById("company-permit").innerHTML = dataPermit.company;
        document.getElementById("departement-permit").innerHTML =
          dataPermit.departement;
        document.getElementById("position-permit").innerHTML = dataPermit.position;
        document.getElementById("img-profile").src = "/" + dataPermit.image;
        document.getElementById("valid-permit").innerHTML = dataPermit.valid;
        document.getElementById("type_permit").innerHTML = dataPermit.type;
        document.getElementById("valid_permit").innerHTML = `: ${dataPermit.valid}`;
        document.getElementById("valid_backside").innerHTML = `Valid : ${dataPermit.valid}`;
      },
    });
  });
</script>
{{ end }}
