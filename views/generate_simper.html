{{ define "content" }}
<style>
  table,
  th,
  td {
    border: 1px solid black;
  }

  table,
  td {
    text-align: center;
    font-weight: 600;
  }
</style>

<div>
  <div class="container" id="page-simper">
    <div class="row">
      <div class="col-lg-6 col-sm-12 mb-4" id="simper-card">
        <div class="d-flex align-items-center justify-content-center">
          <div class="box-simper">
            <div class="group-simper">
              <div class="overlap-simper">
                <div class="rectangle-simper"></div>
                <div class="div-simper" id="violation_simper_L3"></div>
                <div class="rectangle-simper-2" id="violation_simper_L2"></div>
                <div class="rectangle-simper-3" id="violation_simper_L1"></div>
                <div class="text-wrapper-simper">L3</div>
                <div class="text-wrapper-simper-2">L1</div>
                <div class="text-wrapper-simper-3">L2</div>
                <div
                  class="rectangle-simper-4 d-flex align-items-center justify-content-center"
                >
                  <img src="/assets/images/pak_puja.png" class="ttd" alt="" />
                </div>
                <p class="head-of-eng-simper">
                  Marradian Dwi Pujana<br />Kepala Teknik Tambang
                </p>
                <div class="rectangle-simper-5"></div>
                <div class="rectangle-simper-6"></div>
                <div class="overlap-group-wrapper-simper">
                  <div class="overlap-group-simper" id="type_simpol_A">
                    <p class="text-wrapper-simper-5">A</p>
                  </div>
                </div>
                <div class="overlap-wrapper-simper">
                  <div class="div-wrapper-simper" id="type_simpol_BII">
                    <p class="text-wrapper-simper-6">BII</p>
                  </div>
                </div>
                <div class="group-simper-2">
                  <div class="div-wrapper-simper" id="type_simpol_BI">
                    <p class="text-wrapper-simper-7">BI</p>
                  </div>
                </div>
                <div class="text-wrapper-simper-8">JENIS SIMPOL</div>
                <div class="text-wrapper-simper-9">SIMPER</div>
                <div class="rectangle-simper-7"></div>
                <div class="group-simper-3">
                  <div class="overlap-group-simper" id="type_simper_P">
                    <p class="text-wrapper-simper-5">P</p>
                  </div>
                </div>
                <div class="group-simper-4">
                  <div class="div-wrapper-simper" id="type_simper_R">
                    <p class="text-wrapper-simper-5">R</p>
                  </div>
                </div>
                <div class="group-simper-5">
                  <div class="div-wrapper-simper" id="type_simper_Q">
                    <p class="text-wrapper-simper-5">Q</p>
                  </div>
                </div>
                <div class="text-wrapper-simper-10">JENIS SIMPER</div>
                <div class="group-simper-6">
                  <div class="overlap-group-simper" id="gol_darah_A">
                    <p class="text-wrapper-simper-5">A</p>
                  </div>
                </div>
                <div class="group-simper-7">
                  <div class="div-wrapper-simper" id="gol_darah_AB">
                    <p class="text-wrapper-simper-11">AB</p>
                  </div>
                </div>
                <div class="group-simper-8">
                  <div class="div-wrapper-simper" id="gol_darah_O">
                    <p class="text-wrapper-simper-5">O</p>
                  </div>
                </div>
                <div class="group-simper-9">
                  <div class="div-wrapper-simper" id="gol_darah_B">
                    <p class="text-wrapper-simper-5">B</p>
                  </div>
                </div>
                <div class="text-wrapper-simper-12">GOL DARAH</div>
                <div class="text-wrapper-simper-13">No SIMPOL</div>
                <div class="text-wrapper-simper-14">Masa Berlaku</div>
                <div class="text-wrapper-simper-15">Masa SIMPER</div>
                <div class="text-wrapper-simper-16" id="no_simpol">
                  : 941019310641
                </div>
                <div class="text-wrapper-simper-17" id="valid_permit">
                  : 12-10-2023
                </div>
                <div class="text-wrapper-simper-18" id="valid_simper">
                  : 12-10-2023
                </div>
                <div class="text-wrapper-simper-19">JENIS PERALATAN</div>
                <div class="group-simper-10">
                  <table class="col-12 center-table" id="vehicle-list"></table>
                </div>

                <p class="kehilangan-SIMPER">
                  Kehilangan SIMPER &amp; PERMIT dikenakan denda<br />Rp.
                  100.000,-<br />SIMPER wajib dibawa pada saat<br />mengoperasikan
                  unit atau kendaraan
                </p>
                <div class="text-wrapper-simper-28">Pelanggaran</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-6 col-sm-12 mb-4">
        <div class="d-flex align-items-center justify-content-center">
          <div class="box-simper-front">
            <div class="group-simper-front">
              <div class="overlap-group-simper-front">
                <div class="overlap-simper-front">
                  <div class="div-simper-front">
                    <div class="rectangle-simper-front"></div>
                    <div class="rectangle-simper-front-2"></div>
                    <div class="text-wrapper-simper-front">SIMPER</div>
                    <div class="text-wrapper-simper-front-2">KARYAWAN</div>
                  </div>
                  <img
                    class="image-simper-front"
                    src="/assets/images/alamkaryalogo.png"
                  />
                  <div class="text-wrapper-simper-front-3">
                    PT.ALAM KARYA GEMILANG
                  </div>
                </div>
                <div class="data-user-simper">
                  <div>
                    Reg
                    <p class="reg-simper-front" id="reg-simper-front"></p>
                  </div>
                  <div>
                    Nama
                    <p class="name-simper-front" id="name-simper-front"></p>
                  </div>
                  <div>
                    NIK
                    <p class="nik-simper-front" id="nik-simper-front"></p>
                  </div>
                  <div>
                    Perusahaan
                    <p
                      class="company-simper-front text-uppercase"
                      id="company-simper-front"
                    ></p>
                  </div>
                  <div>
                    Departemen
                    <p
                      id="departement-simper-front"
                      class="departement-simper-front text-uppercase"
                    ></p>
                  </div>
                  <div>
                    Jabatan
                    <p
                      id="position-simper-front"
                      class="position-simper-front"
                    ></p>
                  </div>
                </div>
                <div class="div-wrapper-simper-front" id="violation_front_L1">
                  <div class="text-wrapper-simper-front-4">L1</div>
                </div>
                <div class="overlap-simper-front-2" id="violation_front_L2">
                  <div class="text-wrapper-simper-front-5">L2</div>
                </div>
                <div class="overlap-simper-front-3" id="violation_front_L3">
                  <div class="text-wrapper-simper-front-6">L3</div>
                </div>
                <div class="text-wrapper-simper-front-7">Pelanggaran</div>
                <div class="overlap-simper-front-4">
                  <div class="text-wrapper-simper-front-8">JENIS SIMPER</div>
                  <div class="overlap-simper-front-5" id="type_simper_front_P">
                    <p class="text-wrapper-simper-front-9">P</p>
                  </div>
                  <div class="overlap-simper-front-6" id="type_simper_front_Q">
                    <p class="text-wrapper-simper-front-10">Q</p>
                  </div>
                  <div class="overlap-simper-front-7" id="type_simper_front_R">
                    <p class="text-wrapper-simper-front-11">R</p>
                  </div>
                </div>
                <div class="overlap-simper-front-8">
                  <img class="img-simper-front" id="img-profile-simper" />
                  <div class="rectangle-simper-front-3"></div>
                  <div class="rectangle-simper-front-4"></div>
                  <div
                    class="rectangle-simper-front-5"
                    id="type_simpol_front_A"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-12"
                    id="type_simpol_front_text_A"
                  >
                    A
                  </div>
                  <div
                    class="rectangle-simper-front-6"
                    id="type_simpol_front_BI"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-13"
                    id="type_simpol_front_text_BI"
                  >
                    BI
                  </div>
                  <div
                    class="rectangle-simper-front-7"
                    id="gol_darah_front_A"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-14"
                    id="gol_darah_front_text_A"
                  >
                    A
                  </div>
                  <div
                    class="rectangle-simper-front-8"
                    id="gol_darah_front_B"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-15"
                    id="gol_darah_front_text_A"
                  >
                    B
                  </div>
                  <div
                    class="rectangle-simper-front-9"
                    id="gol_darah_front_O"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-16"
                    id="gol_darah_front_text_O"
                  >
                    o
                  </div>
                  <div
                    class="rectangle-simper-front-10"
                    id="gol_darah_front_AB"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-17"
                    id="gol_darah_front_text_AB"
                  >
                    AB
                  </div>
                  <div
                    class="rectangle-simper-front-11"
                    id="type_simpol_front_BII"
                  ></div>
                  <div
                    class="text-wrapper-simper-front-18"
                    id="type_simpol_front_text_BII"
                  >
                    BII
                  </div>
                  <div class="text-wrapper-simper-front-19">JENIS SIM-POL</div>
                  <div class="text-wrapper-simper-front-20">GOLONGAN DARAH</div>
                  <div class="text-wrapper-simper-front-21">
                    <p>Tanda Tangan</p>
                    <div
                      class="rectangle-simper-front-50 d-flex align-items-center justify-content-center"
                    >
                      <img
                        src="/assets/images/pak_puja.png"
                        class="ttd"
                        alt=""
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex align-items-center justify-content-center">
    <a
      class="btn btn-danger text-white delete-btn"
      type="button"
      onclick="printPage()"
      >Download Simper</a
    >
  </div>
</div>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"
></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
  integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
<script>
  $(document).ready(function () {
    var id = new URLSearchParams(window.location.search).get("id");

    $.ajax({
      url: "/detail/permit?id=" + id,
      method: "get",
      success: function (data) {
        const dataPermit = data.permit;
        const dataSimper = data.simper;
        if (dataPermit.is_simper) {
          switch (dataSimper.simper_type) {
            case "P":
            case "Q":
            case "R":
              setBackgroundColorById(
                "type_simper_" + dataSimper.simper_type,
                "#ffe500"
              );
              setBackgroundColorFrontById(
                "type_simper_front_" + dataSimper.simper_type,
                "#ffe500"
              );
              break;
          }

          switch (dataSimper.simpol) {
            case "A":
            case "BI":
            case "BII":
              setBackgroundColorById(
                "type_simpol_" + dataSimper.simpol,
                "#ffe500"
              );
              setBackgroundColorAndTextColorById(
                "type_simpol_front_" + dataSimper.simpol,
                "type_simpol_front_text_" + dataSimper.simpol,
                "#ffe500"
              );
              break;
          }

          switch (dataSimper.blood_type) {
            case "A":
            case "B":
            case "O":
            case "AB":
              setBackgroundColorById(
                "gol_darah_" + dataSimper.blood_type,
                "#ffe500"
              );
              setBackgroundColorAndTextColorById(
                "gol_darah_front_" + dataSimper.blood_type,
                "gol_darah_front_text_" + dataSimper.blood_type,
                "#ffe500"
              );
              break;
          }

          let htmlTable = "";
          for (let i = 0; i < 5; i++) {
            const row = dataSimper.vehicle[i] || {};
            const typeVehicle = (row.type_vehicle || "").toUpperCase();

            htmlTable += `
              <tr>
                <td>${i + 1}</td>
                <td style="background-color: ${
                  typeVehicle === "F" ? "#ffe500" : "inherit"
                };">F</td>
                <td style="background-color: ${
                  typeVehicle === "P" ? "#ffe500" : "inherit"
                };">P</td>
                <td style="background-color: ${
                  typeVehicle === "T" ? "#ffe500" : "inherit"
                };">T</td>
                <td>${row.name_vehicle || ""}</td>
              </tr>
            `;
          }
          $("#vehicle-list").html(htmlTable);

          document.getElementById(
            "valid_simper"
          ).innerHTML = `: ${dataSimper.simper_valid}`;
          document.getElementById(
            "no_simpol"
          ).innerHTML = `: ${dataSimper.no_simpol}`;
        } else {
          const elementSimper = document.getElementById("simper-card");
          elementSimper.classList.add("d-none");
        }

        document.getElementById(
          "reg-simper-front"
        ).innerHTML = `: ${dataPermit.region}`;
        document.getElementById(
          "name-simper-front"
        ).innerHTML = `: ${dataPermit.name}`;
        document.getElementById(
          "nik-simper-front"
        ).innerHTML = `: ${dataPermit.nik}`;
        document.getElementById(
          "company-simper-front"
        ).innerHTML = `: ${dataPermit.company}`;
        document.getElementById(
          "departement-simper-front"
        ).innerHTML = `: ${dataPermit.departement}`;
        document.getElementById(
          "position-simper-front"
        ).innerHTML = `: ${dataPermit.position}`;
        document.getElementById("img-profile-simper").src =
          "/" + dataPermit.image;
      },
    });
  });

  function setBackgroundColorById(elementId, color) {
    var myDiv = document.getElementById(elementId);
    if (myDiv) {
      myDiv.style.backgroundColor = color;
    }
  }

  function setBackgroundColorFrontById(elementId, color) {
    var myDiv = document.getElementById(elementId);
    if (myDiv) {
      myDiv.style.backgroundColor = color;
      var myPTag = myDiv.querySelector("p");
      myPTag.style.color = "#000000";
    }
  }

  function setBackgroundColorAndTextColorById(elementId, elementTextId, color) {
    var myDiv = document.getElementById(elementId);
    var myText = document.getElementById(elementTextId);
    if (myDiv) {
      myDiv.style.backgroundColor = color;
    }
    myText.style.color = "#000000";
  }

  function printPage() {
    var page = document.getElementById("page-simper");
    html2pdf(page);
  }
</script>
{{ end }}
