<!DOCTYPE html>
<html>
  <head>
    <title>{{ .title }}</title>
    <link type="text/css" rel="stylesheet" href="/assets/css/main.css" />
    <script src="/assets/js/main.js"></script>
    <meta
      name="viewport"
      content="width = device-width, initial-scale = 1, shrink-to-fit=no"
    />

    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
      integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="
https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css
"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-dark bg-primary" id="side-nav">
      <button
        class="navbar-toggler navbar-toggler-right"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="#">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/Temporary_file_letter_A.svg/1200px-Temporary_file_letter_A.svg.png"
          width="30"
          height="30"
          class="d-inline-block align-top"
          alt=""
        />
        <span class="menu-collapsed">CA</span>
      </a>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <div class="d-flex mr-lg-5">
                <div class="btn-group">
                  <a
                    class="btn dropdown-toggle text-white"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                  >
                    <span class="fa fa-user fa-md text-white"></span>
                  </a>
                  <div class="dropdown-menu">
                    <a class="dropdown-item" onclick="logout()">Logout</a>
                  </div>
                </div>
              </div>
          </li>
        </ul>
      </div>
    </nav>
    <div class="row" id="body-row">
      <div id="sidebar-container" class="sidebar-expanded d-none d-md-block bg-primary">
        <ul id="list-group-bar" class="list-group">
          <a
            href="#submenu2"
            data-toggle="collapse"
            aria-expanded="false"
            class="bg-primary list-group-item list-group-item-action flex-column align-items-start"
          >
            <div class="d-flex w-100 justify-content-start align-items-center">
              <span class="fa fa-list fa-fw mr-3"></span>
              <span class="menu-collapsed">My Permit</span>
              <span class="submenu-icon ml-auto"></span>
            </div>
          </a>
          <div id="submenu2" class="collapse sidebar-submenu">
            <a
              href="/list/permit"
              class="list-group-item list-group-item-action bg-primary text-white"
            >
              <span class="menu-collapsed">List Permit</span>
            </a>
            <a
              id="create-permit"
              href="/create/permit"
              class="list-group-item list-group-item-action bg-primary text-white"
            >
              <span class="menu-collapsed">Create Permit</span>
            </a>
          </div>
        </ul>
      </div>
      <div class="col p-4" id="col-content">
        <div class="card" id="card-content">
            <div class="card-body" id="card-body-content">
                {{ template "content" . }}
            </div>
        </div>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
    <script src="
https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js
"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

    <script>
        function logout() {
            $.ajax({
                url: "/logout",
                method: "get",
                success: function (result) {
                    event.preventDefault();
                    window.location.replace("/login");
                },
            });
        }

        $(document).ready(function () {
          const value = $.cookie("user-name");

          $.ajax({
            url: "/detail/permit/by-name?name=" + value,
            method: "get",
            success: function (result) {
              if (result.code !== 404) {
                const element = document.getElementById("create-permit");
                element.classList.add("d-none");
              }
            },
          });

          let currentPath = document.location.pathname;

          const blockListPath = ["/generate/permit", "/login", "/backside/permit"];
          $.each(blockListPath, function (index, value) {
            if (currentPath === value) {
              const element = document.getElementById("side-nav");
              const elementListGroup = document.getElementById("list-group-bar");

              element.classList.add("d-none");
              elementListGroup.classList.add("d-none");

              $("#sidebar-container").addClass("bg-white");
              $("#col-content").removeClass("col");
              $("#card-content").removeClass("card");
              $("#card-body-content").removeClass("card-body");
              $("#body-row").removeClass("row");

              $("#sidebar-container").css("min-height", "0");
            }
          });
        });
    </script>
  </body>
</html>
